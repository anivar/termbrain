#!/usr/bin/env bash
# Termbrain Clean Architecture Entry Point

export TERMBRAIN_VERSION="2.0.0"
export TERMBRAIN_HOME="${TERMBRAIN_HOME:-$HOME/.termbrain}"
export TERMBRAIN_DB="$TERMBRAIN_HOME/data/termbrain.db"

# Source the CLI router - use local path if in development
if [[ -f "./lib/presentation/cli_router.sh" ]]; then
    export TERMBRAIN_LIB="./lib"
    source "./lib/presentation/cli_router.sh"
else
    export TERMBRAIN_LIB="${TERMBRAIN_HOME}/lib"
    source "${TERMBRAIN_HOME}/lib/presentation/cli_router.sh"
fi

# Main entry point
main() {
    local command="${1:-help}"
    shift
    
    case "$command" in
        workflow)
            CLIRouter::workflow "$@"
            ;;
        help|--help|-h)
            echo "ðŸ§  Termbrain - Clean Architecture"
            echo ""
            echo "Commands:"
            echo "  tb workflow    # Manage workflows"
            echo "  tb help        # Show this help"
            ;;
        *)
            echo "Unknown command: $command"
            echo "Run 'tb help' for usage"
            return 1
            ;;
    esac
}

# Run if executed directly
if [[ "${BASH_SOURCE[0]}" == "${0}" ]]; then
    main "$@"
fi